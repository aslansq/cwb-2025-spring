
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Skill Review 1 Analysis</title>
<style>
	.progress-container {
		width: 300px;
		background-color: #f3f3f3;
		border-radius: 25px;
		overflow: hidden;
	}
	.progress-bar-red {
		width: 70%;
		height: 30px;
		background-color: red;
		text-align: center;
		line-height: 30px;
		color: white;
	}
	.progress-bar-green {
		width: 70%;
		height: 30px;
		background-color: #4caf50;
		text-align: center;
		line-height: 30px;
		color: white;
	}
	.log-container {
		width: 100%;
		height: 200px;
		overflow-y: scroll;
		border: 1px solid #ccc;
		padding: 10px;
	}
</style>
</head>

<body>
	<div class="progress-container" id="progress-container-id">
	</div>

	<br>

	<div class="log-container" id="log-container-id"></div>
	<script src="data.js"></script>
	<script>
		let fakeQuizData = true

		if(fakeQuizData == true) {
			quizData = {
				// copilot magic
				"correct" : {
					"q1": "C", "q2": "B", "q3": "C", "q4": "D", "q5": "A",
					"q6": "B", "q7": "A", "q8": "D", "q9": "A", "q10": "B",
					"q11": "C", "q12": "D", "q13": "A", "q14": "A", "q15": "C",
					"q16": "D", "q17": "A", "q18": "B"
				},
				"Abdul" : {
					"q1": "A", "q2": "B", "q3": "C", "q4": "D", "q5": "A",
					"q6": "B", "q7": "C", "q8": "D", "q9": "A", "q10": "B",
					"q11": "C", "q12": "D", "q13": "A", "q14": "B", "q15": "C",
					"q16": "D", "q17": "A", "q18": "B"
				},
				"Aleksi" : {
					"q1": "C", "q2": "G", "q3": "C", "q4": "D", "q5": "A",
					"q6": "B", "q7": "E", "q8": "L", "q9": "C", "q10": "B",
					"q11": "C", "q12": "D", "q13": "A", "q14": "B", "q15": "C",
					"q16": "D", "q17": "F", "q18": "B"
				},
				"Svetlana" : {
					"q1": "A", "q2": "M", "q3": "C", "q4": "O", "q5": "A",
					"q6": "B", "q7": "C", "q8": "D", "q9": "A", "q10": "B",
					"q11": "R", "q12": "D", "q13": "A", "q14": "P", "q15": "C",
					"q16": "D", "q17": "A", "q18": "B"
				},
				"Azizi" : {
					"q1": "A", "q2": "S", "q3": "C", "q4": "D", "q5": "A",
					"q6": "B", "q7": "C", "q8": "T", "q9": "A", "q10": "B",
					"q11": "C", "q12": "D", "q13": "A", "q14": "K", "q15": "C",
					"q16": "D", "q17": "A", "q18": "B"
				},
			}

		}
		
		class Logger {
			constructor(level) {
				const debug = 0
				const release = 1
				this.level = level
				this.logContainer = document.getElementById('log-container-id');
			}

			debug(...args) {
				if(this.level != this.debug) {
					return
				}
				this.logContainer.innerHTML += args.join(' ') + '<br>';
			}

			release(...args) {
				console.log(...args)
				this.logContainer.innerHTML += args.join(' ') + '<br>';
			}
		}


		logLevel = new Logger(0).release
		logger = new Logger(logLevel)
		
		class Quiz {
			constructor(personName) {
				this.correctAnswers = quizData["correct"]
				this.numOfQ = 18
				this.personName = personName
				
				if (!quizData.hasOwnProperty(this.personName)) {
					throw new Error(`${this.personName} does not exist in quizData`);
				}

				this.answers = quizData[this.personName]
				this.missing = this.getMissing()
				this.correct = this.getCorrect()
				this.wrong = this.getWrong()
			}

			getMissing() {
				let collected = []
				for(let i = 0; i < this.numOfQ; ++i) {
					let questionKey = "q" + (i + 1);
					if (!this.answers.hasOwnProperty(questionKey)) {
						collected.push(questionKey)
					}
				}
				return collected
			}

			getWrong() {
				let collected = []
				for(let i = 0; i < this.numOfQ; ++i) {
					let questionKey = "q" + (i+1)
					if(
						this.answers.hasOwnProperty(questionKey) &&
						this.answers[questionKey] != this.correctAnswers[questionKey]
					) {
						collected.push(questionKey)
					}
				}
				return collected
			}

			getCorrect() {
				let collected = []
				for(let i = 0; i < this.numOfQ; ++i) {
					let questionKey = "q" + (i+1)
					if(
						this.answers.hasOwnProperty(questionKey) &&
						this.answers[questionKey] == this.correctAnswers[questionKey]
					) {
						collected.push(questionKey)
					}
				}
				return collected
			}

			answeredCorrect(question) {
				return this.correct.includes(question)
			}

			report() {
				logger.release("missing > ", this.missing)
				logger.release("wrong > ", this.wrong)
				logger.release("correct > ", this.correct)
			}
		}

		class Classroom {
			constructor() {
				this.okPercentage = 70
				this.people = ["Abdul", "Aleksi", "Svetlana", "Azizi"]
				this.peopleWQuiz = this.getPeopleWQuiz(this.people)
				this.peopleWithoutQuiz = this.getPeopleWithoutQuiz(this.people)
				this.numOfPeopleSubmitted = this.peopleWQuiz.length
				this.submitPercentage = this.numOfPeopleSubmitted / this.people.length * 100.0
				this.progressContainer = document.getElementById('progress-container-id');
				this.numOfCorrectAns = this.getNumOfCorrectAns()
			}

			getPeopleWithoutQuiz(people) {
				let peopleWithoutQuiz = []
				for(let i = 0; i < people.length; ++i) {
					let person = people[i]
					// lets try to get their quiz
					try {
						let elem = {
							"name" : person,
							"quiz" : new Quiz(person)
						}
					} catch(e) {
						peopleWithoutQuiz.push(person)
					}
				}
				return peopleWithoutQuiz
			}

			getPeopleWQuiz(people) {
				let peopleWQuiz = []
				for(let i = 0; i < people.length; ++i) {
					let person = people[i]
					// lets try to get their quiz
					try {
						let elem = {
							"name" : person,
							"quiz" : new Quiz(person)
						}
						peopleWQuiz.push(elem)
					} catch(e) {
						// do nothing
					}
				}
				return peopleWQuiz
			}

			getNumOfCorrectAns() {
				if(this.peopleWQuiz.length == 0) {
					return {}
				}

				let numOfQ = this.peopleWQuiz[0]["quiz"].numOfQ
				let numOfCorrectAns = {}

				for(let i = 0; i < numOfQ; ++i) {
					let q = 'q' + (i+1)
					numOfCorrectAns[q] = 0;
				}

				for(let i = 0; i < this.peopleWQuiz.length; ++i) {
					let personName = this.peopleWQuiz[i]["name"]
					let quiz = this.peopleWQuiz[i]["quiz"]
					for(let j = 0; j < quiz.numOfQ; j++) {
						let q = 'q' + (j+1)
						let answeredCorrect = quiz.answeredCorrect(q)
						if(answeredCorrect == true) {
							numOfCorrectAns[q] += 1
						}
					}
				}

				return numOfCorrectAns
			}

			consoleReport() {
				for(let i = 0; i < this.peopleWQuiz.length; ++i) {
					let personName = this.peopleWQuiz[i]["name"]
					let quiz = this.peopleWQuiz[i]["quiz"]
					logger.release("-------------------------------------")
					logger.release(personName)
					logger.release(quiz.report())
				}
				logger.release("-------------------------------------")
				for(let i = 0; i < this.peopleWithoutQuiz.length; ++i) {
					let personName = this.peopleWithoutQuiz[i]
					logger.release(personName, " did not submit :(")
				}
			}

			getProgressBar(name, percentage) {
				let s = `<p>${name}:</p>`;
				if(percentage >= this.okPercentage) {
					s += `<div class="progress-bar-green" style="width: ${percentage}%;">${percentage}%</div>`;
				} else {
					s += `<div class="progress-bar-red" style="width: ${percentage}%;">${percentage}%</div>`;
				}
				
				return s
			}

			report() {
				let numOfQ = 0

				this.consoleReport()
				
				this.progressContainer.innerHTML = this.getProgressBar("Submit Rate", this.submitPercentage)

				if(this.peopleWQuiz.length != 0) {
					numOfQ = this.peopleWQuiz[0]["quiz"].numOfQ
				} else {
					logger.release("Really there is not even one person. That is just sad.")
					return
				}

				for(let i = 0; i < numOfQ; ++i) {
					let q = 'q' + (i+1)
					let percentage = this.numOfCorrectAns[q] / this.numOfPeopleSubmitted * 100.0
					this.progressContainer.innerHTML += this.getProgressBar(q, percentage)
				}

			}
		}

		let classrom = new Classroom()
		classrom.report()
		
	</script>

</body>
</html>